(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,o=window.wp.element,n=window.wp.compose,r=window.wp.components,a=window.wp.data,s=window.wp.hooks,i=window.wp.apiFetch;var c=e.n(i);class l extends o.Component{constructor(){super(...arguments),this.state={selected:0,options:[],message:""}}componentDidMount(){const{hazardType:e}=this.props;c()({path:"/wp/v2/hazard_type?per_page=-1"}).then((t=>{const o=t.map((e=>({label:e.name,value:e.id})));if(this.setState({options:o,message:""}),e&&e[0])this.setState({selected:e[0]});else{const e=o[0].value;this.onUpdateHazardType({option:e})}}),(e=>{this.setState({message:e.message})}))}onUpdateHazardType(e){const{onChangeHazardType:t}=this.props;this.setState({selected:parseInt(e.option,10)}),t(e.option)}render(){const{selected:e,options:o,message:n}=this.state,{taxonomy:a}=this.props;let s;return o&&o.length>1&&(s=(0,t.createElement)(r.SelectControl,{value:e,options:o,onChange:e=>{this.onUpdateHazardType({option:e})}})),(0,t.createElement)("div",null,a&&""!==a.description&&(0,t.createElement)("p",null,a.description),s,n&&(0,t.createElement)("p",{className:"error"},n))}}const p=(0,n.compose)([(0,a.withSelect)((e=>{const t={hazardType:e("core/editor").getEditedPostAttribute("hazard_type")},o=e("core").getEntityRecord("taxonomy","hazard_type",t.hazardType[0]);return o&&(document.body.className=document.body.className.replace(/(^|\s)hazard_type-\S+/g,""),document.body.classList.add("hazard_type-"+o.slug)),t})),(0,a.withDispatch)((e=>({onChangeHazardType:t=>{e("core/editor").editPost({hazard_type:[t]})}})))])(l);(0,s.addFilter)("editor.PostTaxonomyType","emergency-info",(e=>{const o=o=>{const{slug:n}=o;return"hazard_type"===n?(0,t.createElement)(p,{...o}):(0,t.createElement)(e,{...o})};return o.displayName="hazardTypeFilter",o}));const d=window.wp.blockEditor,m=window.wp.i18n;(0,s.addFilter)("blocks.registerBlockType","emergency-info/hideblock-attribute",(e=>(!["core/archives","core/calendar","core/latest-comments","core/tag-cloud"].includes(e.name)&&Object.hasOwn(e,"attributes")&&(e.attributes.hideBlock={type:"boolean",default:!1}),e)));const u=(0,n.createHigherOrderComponent)((e=>{const n=n=>{const{hideBlock:a}=n.attributes,{setAttributes:s}=n;return(0,t.createElement)(o.Fragment,null,(0,t.createElement)("div",{className:a?"hidden-block":""},(0,t.createElement)(e,{...n})),(0,t.createElement)(d.BlockControls,null,(0,t.createElement)(r.ToolbarGroup,null,(0,t.createElement)(r.ToolbarItem,{as:r.Button,onClick:()=>{s(!0===a?{hideBlock:!1}:{hideBlock:!0})}},!0===a?(0,t.createElement)(r.Dashicon,{icon:"hidden"}):(0,t.createElement)(r.Dashicon,{icon:"visibility"})))),(0,t.createElement)(d.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,m.__)("Visibility")},(0,t.createElement)(r.ToggleControl,{label:(0,m.__)("Hide block"),checked:a,onChange:e=>s({hideBlock:e})}))))};return n.displayName="withInspectorControl",n}),"withInspectorControl");(0,s.addFilter)("editor.BlockEdit","emergency-info/hideblock-controls",u);class h extends o.Component{constructor(){super(...arguments),this.state={selected:[],options:{},regionGroupRegionMap:{},groupTypeLabelMap:{},message:""}}componentDidMount(){const{regionGroups:e}=this.props;c()({path:"/wp/v2/region-group"}).then((t=>{const o={},n={other:"Other"};for(const e of t){var r;const t=null!==(r=e.group_type.value)&&void 0!==r?r:"other";n[t]=e.group_type.label,Object.prototype.hasOwnProperty.call(o,t)||(o[t]=[]),o[t].push({label:e.name,value:e.term_id,type:t})}const a={};for(const e of t)a[e.term_id]=e.included_regions;this.setState({selected:e,options:o,regionGroupRegionMap:a,groupTypeLabelMap:n,message:""})}),(e=>{this.setState({message:e.message})}))}onUpdateRegionGroup(e){const{onChangeRegionGroup:t,regions:o}=this.props,{selected:n}=this.state,{regionGroupId:r,includedRegions:a}=e;let s=-1,i=[],c=n;(s=n.indexOf(r))>-1?(c.splice(s,1),i=o.filter((e=>!a.includes(e)))):(c.push(r),i=o.concat(a),i=[...new Set(i)]),this.setState({selected:c}),t(c,i)}render(){const{selected:e,options:o,regionGroupRegionMap:n,groupTypeLabelMap:a,message:s}=this.state,{taxonomy:i}=this.props;let c=[];if(o)for(const s in o){const i=o[s].map((o=>{const a=o.value,s=o.label;return(0,t.createElement)(r.PanelRow,{className:"mt-0",key:a},(0,t.createElement)(r.CheckboxControl,{className:"region-group-checkbox-control",label:s,value:a,checked:e.includes(a),onChange:()=>{const e=n[a];this.onUpdateRegionGroup({regionGroupId:a,includedRegions:e})}}))}));c.push((0,t.createElement)(r.Panel,null,(0,t.createElement)(r.PanelBody,{title:a[s],initialOpen:0===c.length},i)))}return(0,t.createElement)("div",null,i&&""!==i.description&&(0,t.createElement)("p",null,i.description),c,s&&(0,t.createElement)("p",{className:"error"},s))}}const g=(0,n.compose)([(0,a.withSelect)((e=>({regionGroups:e("core/editor").getEditedPostAttribute("region_groups"),regions:e("core/editor").getEditedPostAttribute("region")}))),(0,a.withDispatch)((e=>({onChangeRegionGroup:(t,o)=>{0===o.length&&(o=[-1]),e("core/editor").editPost({region:o,region_groups:t.map((e=>e.toString()))})}})))])(h);(0,s.addFilter)("editor.PostTaxonomyType","emergency-info",(e=>{const o=o=>{const{slug:n}=o;return"region_groups"===n?(0,t.createElement)(g,{...o}):(0,t.createElement)(e,{...o})};return o.displayName="regionGroupFilter",o})),(0,window.wp.blocks.registerBlockVariation)("core/paragraph",{name:"recommended_actions",title:"Recommended Actions",attributes:{metadata:{bindings:{content:{source:"core/post-meta",args:{key:"recommended_actions"}}}}}})})();