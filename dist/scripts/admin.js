(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var s in o)e.o(o,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:o[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,o=window.wp.compose,s=window.wp.components,n=window.wp.data,r=window.wp.hooks,i=window.wp.apiFetch;var a=e.n(i);const c=window.ReactJSXRuntime;class d extends t.Component{constructor(){super(...arguments),this.state={selected:0,options:[],message:""}}componentDidMount(){const{hazardType:e}=this.props;a()({path:"/wp/v2/hazard_type?per_page=-1"}).then((t=>{const o=t.map((e=>({label:e.name,value:e.id})));if(this.setState({options:o,message:""}),e&&e[0])this.setState({selected:e[0]});else{const e=o[0].value;this.onUpdateHazardType({option:e})}}),(e=>{this.setState({message:e.message})}))}onUpdateHazardType(e){const{onChangeHazardType:t}=this.props;this.setState({selected:parseInt(e.option,10)}),t(e.option)}render(){const{selected:e,options:t,message:o}=this.state,{taxonomy:n}=this.props;let r;return t&&t.length>1&&(r=(0,c.jsx)(s.SelectControl,{value:e,options:t,onChange:e=>{this.onUpdateHazardType({option:e})}})),(0,c.jsxs)("div",{children:[n&&""!==n.description&&(0,c.jsx)("p",{children:n.description}),r,o&&(0,c.jsx)("p",{className:"error",children:o})]})}}const p=(0,o.compose)([(0,n.withSelect)((e=>{const t={hazardType:e("core/editor").getEditedPostAttribute("hazard_type")},o=e("core").getEntityRecord("taxonomy","hazard_type",t.hazardType[0]);return o&&(document.body.className=document.body.className.replace(/(^|\s)hazard_type-\S+/g,""),document.body.classList.add("hazard_type-"+o.slug)),t})),(0,n.withDispatch)((e=>({onChangeHazardType:t=>{e("core/editor").editPost({hazard_type:[t]})}})))])(d);(0,r.addFilter)("editor.PostTaxonomyType","emergency-info",(e=>{const t=t=>{const{slug:o}=t;return"hazard_type"===o?(0,c.jsx)(p,{...t}):(0,c.jsx)(e,{...t})};return t.displayName="hazardTypeFilter",t}));const l=window.wp.blockEditor,h=window.wp.i18n;(0,r.addFilter)("blocks.registerBlockType","emergency-info/hideblock-attribute",(e=>(!["core/archives","core/calendar","core/latest-comments","core/tag-cloud"].includes(e.name)&&Object.hasOwn(e,"attributes")&&(e.attributes.hideBlock={type:"boolean",default:!1}),e)));const u=(0,o.createHigherOrderComponent)((e=>{const o=o=>{const{hideBlock:n}=o.attributes,{setAttributes:r}=o;return(0,c.jsxs)(t.Fragment,{children:[(0,c.jsx)("div",{className:n?"hidden-block":"",children:(0,c.jsx)(e,{...o})}),(0,c.jsx)(l.BlockControls,{children:(0,c.jsx)(s.ToolbarGroup,{children:(0,c.jsx)(s.ToolbarItem,{as:s.Button,onClick:()=>{r(!0===n?{hideBlock:!1}:{hideBlock:!0})},children:!0===n?(0,c.jsx)(s.Dashicon,{icon:"hidden"}):(0,c.jsx)(s.Dashicon,{icon:"visibility"})})})}),(0,c.jsx)(l.InspectorControls,{children:(0,c.jsx)(s.PanelBody,{title:(0,h.__)("Visibility"),children:(0,c.jsx)(s.ToggleControl,{label:(0,h.__)("Hide block"),checked:n,onChange:e=>r({hideBlock:e})})})})]})};return o.displayName="withInspectorControl",o}),"withInspectorControl");(0,r.addFilter)("editor.BlockEdit","emergency-info/hideblock-controls",u);class g extends t.Component{constructor(){super(...arguments),this.state={selected:[],options:{},regionGroupRegionMap:{},groupTypeLabelMap:{},message:""}}componentDidMount(){const{regionGroups:e}=this.props;a()({path:"/wp/v2/region-group"}).then((t=>{const o={},s={other:"Other"};for(const e of t){var n;const t=null!==(n=e.group_type.value)&&void 0!==n?n:"other";s[t]=e.group_type.label,Object.prototype.hasOwnProperty.call(o,t)||(o[t]=[]),o[t].push({label:e.name,value:e.term_id,type:t})}const r={};for(const e of t)r[e.term_id]=e.included_regions;this.setState({selected:e,options:o,regionGroupRegionMap:r,groupTypeLabelMap:s,message:""})}),(e=>{this.setState({message:e.message})}))}onUpdateRegionGroup(e){const{onChangeRegionGroup:t,regions:o}=this.props,{selected:s}=this.state,{regionGroupId:n,includedRegions:r}=e;let i=-1,a=[],c=s;(i=s.indexOf(n))>-1?(c.splice(i,1),a=o.filter((e=>!r.includes(e)))):(c.push(n),a=o.concat(r),a=[...new Set(a)]),this.setState({selected:c}),t(c,a)}render(){const{selected:e,options:t,regionGroupRegionMap:o,groupTypeLabelMap:n,message:r}=this.state,{taxonomy:i}=this.props;let a=[];if(t)for(const r in t){const i=t[r].map((t=>{const n=t.value,r=t.label;return(0,c.jsx)(s.PanelRow,{className:"mt-0",children:(0,c.jsx)(s.CheckboxControl,{className:"region-group-checkbox-control",label:r,value:n,checked:e.includes(n),onChange:()=>{const e=o[n];this.onUpdateRegionGroup({regionGroupId:n,includedRegions:e})}})},n)}));a.push((0,c.jsx)(s.Panel,{children:(0,c.jsx)(s.PanelBody,{title:n[r],initialOpen:0===a.length,children:i})}))}return(0,c.jsxs)("div",{children:[i&&""!==i.description&&(0,c.jsx)("p",{children:i.description}),a,r&&(0,c.jsx)("p",{className:"error",children:r})]})}}const m=(0,o.compose)([(0,n.withSelect)((e=>({regionGroups:e("core/editor").getEditedPostAttribute("region_groups"),regions:e("core/editor").getEditedPostAttribute("region")}))),(0,n.withDispatch)((e=>({onChangeRegionGroup:(t,o)=>{0===o.length&&(o=[-1]),e("core/editor").editPost({region:o,region_groups:t.map((e=>e.toString()))})}})))])(g);(0,r.addFilter)("editor.PostTaxonomyType","emergency-info",(e=>{const t=t=>{const{slug:o}=t;return"region_groups"===o?(0,c.jsx)(m,{...t}):(0,c.jsx)(e,{...t})};return t.displayName="regionGroupFilter",t}))})();