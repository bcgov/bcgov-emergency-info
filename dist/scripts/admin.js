!function(){"use strict";var e={n:function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,{a:o}),o},d:function(t,o){for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.React,o=window.wp.element,n=window.wp.compose,r=window.wp.components,s=window.wp.data,a=window.wp.hooks,i=window.wp.apiFetch,c=e.n(i);class l extends o.Component{constructor(){super(...arguments),this.state={selected:0,options:[],message:""}}componentDidMount(){const{hazardType:e}=this.props;c()({path:"/wp/v2/hazard_type?per_page=-1"}).then((t=>{const o=t.map((e=>({label:e.name,value:e.id})));if(this.setState({options:o,message:""}),e&&e[0])this.setState({selected:e[0]});else{const e=o[0].value;this.onUpdateHazardType({option:e})}}),(e=>{this.setState({message:e.message})}))}onUpdateHazardType(e){const{onChangeHazardType:t}=this.props;this.setState({selected:parseInt(e.option,10)}),t(e.option)}render(){const{selected:e,options:o,message:n}=this.state,{taxonomy:s}=this.props;let a;return o&&o.length>1&&(a=(0,t.createElement)(r.SelectControl,{value:e,options:o,onChange:e=>{this.onUpdateHazardType({option:e})}})),(0,t.createElement)("div",null,s&&""!==s.description&&(0,t.createElement)("p",null,s.description),a,n&&(0,t.createElement)("p",{className:"error"},n))}}const p=(0,n.compose)([(0,s.withSelect)((e=>{const t={hazardType:e("core/editor").getEditedPostAttribute("hazard_type")},o=e("core").getEntityRecord("taxonomy","hazard_type",t.hazardType[0]);return o&&(document.body.className=document.body.className.replace(/(^|\s)hazard_type-\S+/g,""),document.body.classList.add("hazard_type-"+o.slug)),t})),(0,s.withDispatch)((e=>({onChangeHazardType:t=>{e("core/editor").editPost({hazard_type:[t]})}})))])(l);(0,a.addFilter)("editor.PostTaxonomyType","emergency-info",(e=>{const o=o=>{const{slug:n}=o;return"hazard_type"===n?(0,t.createElement)(p,{...o}):(0,t.createElement)(e,{...o})};return o.displayName="hazardTypeFilter",o}));var d=window.wp.blockEditor,u=window.wp.i18n;(0,a.addFilter)("blocks.registerBlockType","emergency-info",(e=>(e.attributes.hideBlock={type:"boolean",default:!1},e)));const g=(0,n.createHigherOrderComponent)((e=>{const n=n=>{const{hideBlock:s}=n.attributes,{setAttributes:a}=n;return(0,t.createElement)(o.Fragment,null,(0,t.createElement)(e,{...n}),(0,t.createElement)(d.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,u.__)("Visibility")},(0,t.createElement)(r.ToggleControl,{label:(0,u.__)("Hide block"),checked:s,onChange:e=>a({hideBlock:e})}))))};return n.displayName="withInspectorControl",n}),"withInspectorControl");(0,a.addFilter)("editor.BlockEdit","emergency-info",g);const m=(0,n.createHigherOrderComponent)((e=>{const o=o=>{const{attributes:n}=o,{hideBlock:r}=n,s=r?"hidden-block":"";return(0,t.createElement)(e,{...o,className:s})};return o.displayName="withCustomAttributeClass",o}),"withCustomAttributeClass");(0,a.addFilter)("editor.BlockListBlock","emergency-info",m);class h extends o.Component{constructor(){super(...arguments),this.state={selected:[],options:{},regionGroupRegionMap:{},groupTypeLabelMap:{},message:""}}componentDidMount(){const{regionGroups:e}=this.props;c()({path:"/wp/v2/region-group"}).then((t=>{const o={},n={other:"Other"};for(const e of t){var r;const t=null!==(r=e.group_type.value)&&void 0!==r?r:"other";n[t]=e.group_type.label,Object.prototype.hasOwnProperty.call(o,t)||(o[t]=[]),o[t].push({label:e.name,value:e.term_id,type:t})}const s={};for(const e of t)s[e.term_id]=e.included_regions;this.setState({selected:e,options:o,regionGroupRegionMap:s,groupTypeLabelMap:n,message:""})}),(e=>{this.setState({message:e.message})}))}onUpdateRegionGroup(e){const{onChangeRegionGroup:t,regions:o}=this.props,{selected:n}=this.state,{regionGroupId:r,includedRegions:s}=e;let a=-1,i=[],c=n;(a=n.indexOf(r))>-1?(c.splice(a,1),i=o.filter((e=>!s.includes(e)))):(c.push(r),i=o.concat(s),i=[...new Set(i)]),this.setState({selected:c}),t(c,i)}render(){const{selected:e,options:o,regionGroupRegionMap:n,groupTypeLabelMap:s,message:a}=this.state,{taxonomy:i}=this.props;let c=[];if(o)for(const a in o){const i=o[a].map((o=>{const s=o.value,a=o.label;return(0,t.createElement)(r.PanelRow,{className:"mt-0",key:s},(0,t.createElement)(r.CheckboxControl,{className:"region-group-checkbox-control",label:a,value:s,checked:e.includes(s),onChange:()=>{const e=n[s];this.onUpdateRegionGroup({regionGroupId:s,includedRegions:e})}}))}));c.push((0,t.createElement)(r.Panel,null,(0,t.createElement)(r.PanelBody,{title:s[a],initialOpen:0===c.length},i)))}return(0,t.createElement)("div",null,i&&""!==i.description&&(0,t.createElement)("p",null,i.description),c,a&&(0,t.createElement)("p",{className:"error"},a))}}const y=(0,n.compose)([(0,s.withSelect)((e=>({regionGroups:e("core/editor").getEditedPostAttribute("region_groups"),regions:e("core/editor").getEditedPostAttribute("region")}))),(0,s.withDispatch)((e=>({onChangeRegionGroup:(t,o)=>{0===o.length&&(o=[-1]),e("core/editor").editPost({region:o,region_groups:t.map((e=>e.toString()))})}})))])(h);(0,a.addFilter)("editor.PostTaxonomyType","emergency-info",(e=>{const o=o=>{const{slug:n}=o;return"region_groups"===n?(0,t.createElement)(y,{...o}):(0,t.createElement)(e,{...o})};return o.displayName="regionGroupFilter",o}))}();