(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.jQuery;var o=e.n(t);o()((()=>{const e=o()("#region-select"),t=o()("#region-autocomplete-input"),n=regions,a=update,l=()=>{document.getElementById("region-autocomplete-input").setCustomValidity("")};o()('input[name="tax_region_all"]').on("change",(t=>{"1"===t.target.value?(o()(".region-section").hide(),o()(".all-region-section").show(),e.prop("disabled",!0)):(o()(".region-section").show(),o()(".all-region-section").hide(),e.prop("disabled",!1)),l()})),o()('input[name="tax_region_all"]:checked').trigger("change");const i=()=>{let t="",a="",r=[],s=[];e.val().forEach((e=>{const o=n.findLast((t=>t.value===+e));t+=`<li aria-label="${o.label}" tabindex="0">\n                <span class="term-pill region">\n                    <span>\n                        ${o.label}\n                    </span>\n                    <button class="btn btn-secondary" aria-label="Remove ${o.label}" data-id="${o.value}" tabindex="0"><i class="bi-x-circle-fill"></i></button>\n                </span>\n            </li>`,o.isRegionGroupTerm&&(s=s.concat(o.regionGroups)),r=r.concat(o.regionGroups)}));const c={};r=r.filter((e=>!s.includes(e)&&!Object.hasOwn(c,e)&&(c[e]=!0))),r.forEach((e=>{a+=`<li aria-label="${e}" tabindex="0">\n                <span class="term-pill region-group">\n                    <span>\n                        ${e}\n                    </span>\n                </span>\n            </li>`})),t?o()(".region-autocomplete-label").html("Your locations:"):o()(".region-autocomplete-label").html(""),o()(".region-list").html(t),a?o()(".region-group-autocomplete-label").html("You will also get email updates for:"):o()(".region-group-autocomplete-label").html(""),o()(".region-group-list").html(a),o()(".region-list button").on("click",(t=>{(t=>{const o=e.val(),n=o.indexOf(t);-1!==n&&(o.splice(n,1),e.val(o)),l()})(t.currentTarget.dataset.id),i()}))};t.on("keydown",(function(e){e.keyCode===o().ui.keyCode.TAB&&o()(this).autocomplete("instance").menu.active&&e.preventDefault()})).autocomplete({minLength:0,source:(t,o)=>{if(""===t.term)return void o(n);const a=e.val(),l=new RegExp(`(${t.term.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")})`,"gi");let i=[];for(const e of n){if(a.includes(e.value.toString()))continue;const t=e.label.match(l),o=t?t.length:0,n=e.regionGroups.reduce(((e,t)=>{const o=t.match(l);return(o?o.length:0)+e}),0);e.relevancy=5*o+n,e.relevancy>0&&i.push(e)}i.sort(((e,t)=>t.relevancy-e.relevancy)),o(i)},position:{of:".region-autocomplete"},appendTo:"#listbox-wrapper",classes:{"ui-autocomplete":"soft-shadow"},focus:()=>{const e=o()("#listbox-wrapper").find(".ui-state-active").attr("id");return t.attr("aria-activedescendant",e),o()(".ui-autocomplete div").attr("aria-selected","false"),o()(".ui-autocomplete div.ui-state-active").attr("aria-selected","true"),!1},select:(o,n)=>{const a=n.item.value;return e.val().includes(a)||((t=>{const o=e.val();o.push(t),e.val(o),l()})(a),i()),t.val(""),!1},response:(e,t)=>{0===t.content.length&&t.content.push({value:"",label:"No results found."})}}),o().ui.autocomplete.prototype._renderItem=(e,t)=>{const n=o()("<li></li>");return n.append('<div role="option">'+t.label+"</div>"),!t.isRegionGroupTerm&&t.regionGroups&&n.append('<div class="region-groups">'+t.regionGroups.join(", ")+"</div>"),n.appendTo(e)},o().ui.autocomplete.prototype._renderMenu=function(e,t){const n=this;o().each(t,((t,o)=>{n._renderItemData(e,o)})),o()(e).attr("role","listbox")},i();const r=document.querySelectorAll(".needs-validation");Array.from(r).forEach((e=>{e.addEventListener("submit",(t=>{const o=document.getElementById("region-select"),n=document.getElementById("region-autocomplete-input");n.checkVisibility()&&(o.value.length<1?n.setCustomValidity("You must select at least one location."):n.setCustomValidity(""),n.reportValidity()),e.checkValidity()||(t.preventDefault(),t.stopPropagation())}),!1)})),a&&document.getElementById("subscribe-form").scrollIntoView({behavior:"instant"})}))})();
